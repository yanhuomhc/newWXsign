
<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www/thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!-- Bootstrap core CSS -->
    <link href="../../static/css/bootstrap.min.css" th:href="@{/css/bootstrap.min.css}" rel="stylesheet"/>


</head>

<body>

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="#">签到系统</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav navbar-right">
                <li><a href="#">注销</a></li>
                <li><a th:href="@{loginOut}" th:unless="${session.user == null}">退出登录</a></li>

            </ul>
            <form class="navbar-form navbar-right">
                <input type="text" class="form-control" placeholder="Search..." />
            </form>
        </div>
    </div>
</nav>

<div class="container">
    <br/>
    <br/>
    <br/>
    <br/>


    <div class="row">
        <div class="col-md-2 sidebar">
            <ul class="nav nav-sidebar">
                <li><a href="/toTeacherAdmin">开始点到</a></li>
                <li><a href="/selectSignDetail">签到明细查询</a></li>
                <li><a href="/signResultAccount">签到结果汇总统计</a></li>
                <li class="active"><a href="teacherAdminCourseInfo">课程管理 <span class="sr-only">(current)</span></a></li>
                <li><a href="/toExcel">学生信息导入</a></li>
            </ul>

        </div>

        <div class="col-md-9">
            <div class="row">
                <h1 class="page-header">课程管理</h1>
            </div>

            <div class="container">


                <table id="demo" lay-filter="test"></table>

                <form action="" method="post" th:action="@{/product/AddProductType}">
                    <div class="row">
                        <div class="col-xs-2">课程名</div>
                        <div class="col-xs-3"><input name="categoryName" class="form-control" /></div>
                        <div class="col-xs-2"><button  type="submit" class="btn btn-info">提交</button></div>
                    </div>

                </form>


                <script>
                    /*<![CDATA[*/
                    layui.use('table', function () {
                        var table = layui.table;

                        //第一个实例
                        table.render({
                            elem: '#demo',
                            width: 600
                            , url: '/product/queryProductTypeBypage' //数据接口
                            , page: true //开启分页
                            , cols: [[ //表头
                                {field: 'categoryId', title: 'ID', width: 200, sort: true, fixed: 'left'}
                                , {field: 'categoryName', title: '类型名', width: 200,event: 'setCategoryName', style:'cursor: pointer;'}
                                , {field: 'categoryType', title: '编号', width: 200, sort: true}
                                , {fixed: 'right', width: 150, align: 'center', toolbar: '#barDemo'}

                            ]]
                        });


                        //监听工具条
                        table.on('tool(test)', function (obj) { //注：tool是工具条事件名，test是table原始容器的属性 lay-filter="对应的值"
                            var data = obj.data; //获得当前行数据
                            var layEvent = obj.event; //获得 lay-event 对应的值（也可以是表头的 event 参数对应的值）
                            var tr = obj.tr; //获得当前行 tr 的DOM对象




                            if (layEvent === 'detail') { //查看
                                //do somehing
                            } else if (layEvent === 'del') { //删除
                                layer.confirm('真的删除行么', function (index) {
                                    obj.del(); //删除对应行（tr）的DOM结构，并更新缓存
                                    layer.close(index);
                                    //向服务端发送删除指令

                                    // alert(data.categoryId);
                                    $.ajax({
                                        url: "/product/DelProductType?categoryId=" + data.categoryId,
                                        type: "get",
                                        success: function (data) {
                                            if (data == 1) {
                                                alert("删除成功!");
                                            }


                                        }
                                    });
                                });
                            } else if (layEvent === 'edit') { //编辑
                                //do something

                                //同步更新缓存对应的值
                                obj.update({
                                    username: '123'
                                    , title: 'xxx'
                                });
                            }else if (layEvent==="setCategoryName"){
                                layer.prompt({
                                    formType: 2
                                    ,title: '修改 ID 为 ['+ data.categoryId +'] 的菜品名字'
                                    ,value: data.categoryName
                                }, function(value, index){
                                    layer.close(index);

                                    //这里一般是发送修改的Ajax请求
                                    $.ajax({
                                        url: "/product/UpdateProductType?categoryId=" + data.categoryId+"&categoryName="+value,
                                        type: "get",
                                        success: function (data) {
                                            if (data == 1) {
                                                alert("修改成功!");
                                            }


                                        }
                                    });

                                    //同步更新表格和缓存对应的值
                                    obj.update({
                                        categoryName: value
                                    });

                                })
                            }

                        })});

                    /*]]>*/
                </script>

                <script type="text/html" id="barDemo">

                    <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>

                </script>


            </div>


        </div>
    </div>
</div>

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="../../static/js/jquery.min.js" th:src="@{/js/jquery.min.js}"></script>

<script src="../../static/js/bootstrap.min.js" th:src="@{/js/bootstrap.min.js}"></script>

</body>
</html>
